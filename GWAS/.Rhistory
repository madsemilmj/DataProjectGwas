ltfh$causal <- ifelse(ltfh$P < (0.05)/1000000,1,0)
gwax$causal <- ifelse(gwax$P < (0.05)/1000000,1,0)
cc$causal <- ifelse(cc$P < (0.05)/1000000,1,0)
#calculating-power
ltfhPower <- nrow(subset(ltfh, causal == 1))/1000
gwaxPower <- nrow(subset(gwax, causal == 1))/1000
ccPower <- nrow(subset(cc, causal == 1))/1000
#stringer for true-beta
beta_string <-  paste("./data/BETA","_",format(total_indiv,scientific = F),"_",format(SNP,scientific = F),"_",h*100,"_5.txt", sep="")
true_beta <- data.table::fread(beta_string)
# Joining to get true causals
causals <- true_beta %>%
dplyr::filter(V2 != 0) %>%
dplyr::left_join(select(ltfh,SNP,CHISQ), by = c("V1" = "SNP")) %>%
dplyr::rename("SNP" = "V1", "TrueBeta" = "V2", "CHISQ_ltfh" = "CHISQ") %>%
dplyr::left_join(select(gwax,SNP,CHISQ), by = c("SNP" = "SNP")) %>%
dplyr::rename("CHISQ_gwax" = "CHISQ") %>%
dplyr::left_join(select(cc,SNP,CHISQ), by = c("SNP" = "SNP")) %>%
dplyr::rename("CHISQ_cc" = "CHISQ")
#joining to get nulls
nulls <- true_beta %>%
dplyr::filter(V2 == 0) %>%
dplyr::left_join(select(ltfh,SNP,CHISQ), by = c("V1" = "SNP")) %>%
dplyr::rename("SNP" = "V1", "TrueBeta" = "V2", "CHISQ_ltfh" = "CHISQ") %>%
dplyr::left_join(select(gwax,SNP,CHISQ), by = c("SNP" = "SNP")) %>%
dplyr::rename("CHISQ_gwax" = "CHISQ") %>%
dplyr::left_join(select(cc,SNP,CHISQ), by = c("SNP" = "SNP")) %>%
dplyr::rename("CHISQ_cc" = "CHISQ")
df <- tibble::tibble(MeanNull = mean(nulls$CHISQ_ltfh), MeanCausal = mean(causals$CHISQ_ltfh), Power = ltfhPower, Method = "LT-FH") %>%
dplyr::add_row(MeanNull = mean(nulls$CHISQ_gwax), MeanCausal = mean(causals$CHISQ_gwax), Power = gwaxPower, Method = "GWAX") %>%
dplyr::add_row(MeanNull = mean(nulls$CHISQ_cc), MeanCausal = mean(causals$CHISQ_cc), Power = ccPower, Method = "CaseControl")
#Looping through rest of files (if they exsist) and add them
for (i in 1:9){
file <- paste("./data/NineSims/",i,"/data/LTFH_",format(total_indiv,scientific = F),"_",format(SNP,scientific = F),"_",h*100,"_5_",sib,".qassoc", sep="")
if (file.exists(file)){
# Stringers for the current assoc-files
ltfh_string <- paste("./data/NineSims/",i,"/data/LTFH_",format(total_indiv,scientific = F),"_",format(SNP,scientific = F),"_",h*100,"_5_",sib,".qassoc", sep="")
cc_string <- paste("./data/NineSims/",i,"/data/case_ctrl","_",format(total_indiv,scientific = F),"_",format(SNP,scientific = F),"_",h*100,"_5.assoc", sep="")
gwax_string <- paste("./data/NineSims/",i,"/data/GWAX","_",format(total_indiv,scientific = F),"_",format(SNP,scientific = F),"_",h*100,"_5_",sib,".assoc", sep="")
#Reading assoc files
ltfh <- data.table::fread(ltfh_string)
gwax <- data.table::fread(gwax_string)
cc <- data.table::fread(cc_string)
#adding chisq to ltfh
ltfh$CHISQ <- qchisq(ltfh$P,df=1,lower.tail = FALSE)
#Check for found causals
ltfh$causal <- ifelse(ltfh$P < (0.05)/1000000,1,0)
gwax$causal <- ifelse(gwax$P < (0.05)/1000000,1,0)
cc$causal <- ifelse(cc$P < (0.05)/1000000,1,0)
#calculating-power
ltfhPower <- nrow(subset(ltfh, causal == 1))/1000
gwaxPower <- nrow(subset(gwax, causal == 1))/1000
ccPower <- nrow(subset(cc, causal == 1))/1000
#stringer for true-beta
beta_string <-  paste("./data/NineSims/",i,"/data/BETA","_",format(total_indiv,scientific = F),"_",format(SNP,scientific = F),"_",h*100,"_5.txt", sep="")
true_beta <- data.table::fread(beta_string)
# Joining to get true causals
causals <- true_beta %>%
dplyr::filter(V2 != 0) %>%
dplyr::left_join(select(ltfh,SNP,CHISQ), by = c("V1" = "SNP")) %>%
dplyr::rename("SNP" = "V1", "TrueBeta" = "V2", "CHISQ_ltfh" = "CHISQ") %>%
dplyr::left_join(select(gwax,SNP,CHISQ), by = c("SNP" = "SNP")) %>%
dplyr::rename("CHISQ_gwax" = "CHISQ") %>%
dplyr::left_join(select(cc,SNP,CHISQ), by = c("SNP" = "SNP")) %>%
dplyr::rename("CHISQ_cc" = "CHISQ")
#joining to get nulls
nulls <- true_beta %>%
dplyr::filter(V2 == 0) %>%
dplyr::left_join(select(ltfh,SNP,CHISQ), by = c("V1" = "SNP")) %>%
dplyr::rename("SNP" = "V1", "TrueBeta" = "V2", "CHISQ_ltfh" = "CHISQ") %>%
dplyr::left_join(select(gwax,SNP,CHISQ), by = c("SNP" = "SNP")) %>%
dplyr::rename("CHISQ_gwax" = "CHISQ") %>%
dplyr::left_join(select(cc,SNP,CHISQ), by = c("SNP" = "SNP")) %>%
dplyr::rename("CHISQ_cc" = "CHISQ")
df <- df %>%
dplyr::add_row(MeanNull = mean(nulls$CHISQ_ltfh), MeanCausal = mean(causals$CHISQ_ltfh), Power = ltfhPower, Method = "LT-FH") %>%
dplyr::add_row(MeanNull = mean(nulls$CHISQ_gwax), MeanCausal = mean(causals$CHISQ_gwax), Power = gwaxPower, Method = "GWAX") %>%
dplyr::add_row(MeanNull = mean(nulls$CHISQ_cc), MeanCausal = mean(causals$CHISQ_cc), Power = ccPower, Method = "CaseControl")
}else {print("no file")}
}
NullPlot <- ggplot2::ggplot(df, aes(x=Method, y=MeanNull))+
ggplot2::geom_boxplot()+
ggplot2::theme_light()
CausalPlot <- ggplot2::ggplot(df, aes(x=Method, y=MeanCausal))+
ggplot2::geom_boxplot()+
ggplot2::theme_light()
PowerPlot <- ggplot2::ggplot(df, aes(x=Method, y=Power))+
ggplot2::geom_boxplot()+
ggplot2::theme_light()
return(cowplot::plot_grid(NullPlot,CausalPlot,PowerPlot, ncol = 3))
} else {
print("No data exists! - Try another predefined or run our simulation")
}
setwd("C:/Users/Bruger/OneDrive - Aarhus Universitet/dataprojekt_shiny_app")
total_indiv <- 100000
SNP <- 100000
h <- 0.5
sib <- 1
file <- paste("./data/LTFH","_",format(total_indiv,scientific = F),"_",format(SNP,scientific = F),"_",h*100,"_5_",sib,".qassoc", sep="")
if (file.exists(file)){
# Stringers for the first assoc-files
first_ltfh <- paste("./data/LTFH","_",format(total_indiv,scientific = F),"_",format(SNP,scientific = F),"_",h*100,"_5_",sib,".qassoc", sep="")
first_cc <- paste("./data/case_ctrl","_",format(total_indiv,scientific = F),"_",format(SNP,scientific = F),"_",h*100,"_5.assoc", sep="")
first_gwax <- paste("./data/GWAX","_",format(total_indiv,scientific = F),"_",format(SNP,scientific = F),"_",h*100,"_5_",sib,".assoc", sep="")
#Reading assoc files
ltfh <- data.table::fread(first_ltfh)
gwax <- data.table::fread(first_gwax)
cc <- data.table::fread(first_cc)
#adding chisq to ltfh
ltfh$CHISQ <- qchisq(ltfh$P,df=1,lower.tail = FALSE)
#Check for found causals
ltfh$causal <- ifelse(ltfh$P < (0.05)/1000000,1,0)
gwax$causal <- ifelse(gwax$P < (0.05)/1000000,1,0)
cc$causal <- ifelse(cc$P < (0.05)/1000000,1,0)
#calculating-power
ltfhPower <- nrow(subset(ltfh, causal == 1))/1000
gwaxPower <- nrow(subset(gwax, causal == 1))/1000
ccPower <- nrow(subset(cc, causal == 1))/1000
#stringer for true-beta
beta_string <-  paste("./data/BETA","_",format(total_indiv,scientific = F),"_",format(SNP,scientific = F),"_",h*100,"_5.txt", sep="")
true_beta <- data.table::fread(beta_string)
# Joining to get true causals
causals <- true_beta %>%
dplyr::filter(V2 != 0) %>%
dplyr::left_join(select(ltfh,SNP,CHISQ), by = c("V1" = "SNP")) %>%
dplyr::rename("SNP" = "V1", "TrueBeta" = "V2", "CHISQ_ltfh" = "CHISQ") %>%
dplyr::left_join(select(gwax,SNP,CHISQ), by = c("SNP" = "SNP")) %>%
dplyr::rename("CHISQ_gwax" = "CHISQ") %>%
dplyr::left_join(select(cc,SNP,CHISQ), by = c("SNP" = "SNP")) %>%
dplyr::rename("CHISQ_cc" = "CHISQ")
#joining to get nulls
nulls <- true_beta %>%
dplyr::filter(V2 == 0) %>%
dplyr::left_join(select(ltfh,SNP,CHISQ), by = c("V1" = "SNP")) %>%
dplyr::rename("SNP" = "V1", "TrueBeta" = "V2", "CHISQ_ltfh" = "CHISQ") %>%
dplyr::left_join(select(gwax,SNP,CHISQ), by = c("SNP" = "SNP")) %>%
dplyr::rename("CHISQ_gwax" = "CHISQ") %>%
dplyr::left_join(select(cc,SNP,CHISQ), by = c("SNP" = "SNP")) %>%
dplyr::rename("CHISQ_cc" = "CHISQ")
df <- tibble::tibble(MeanNull = mean(nulls$CHISQ_ltfh), MeanCausal = mean(causals$CHISQ_ltfh), Power = ltfhPower, Method = "LT-FH") %>%
dplyr::add_row(MeanNull = mean(nulls$CHISQ_gwax), MeanCausal = mean(causals$CHISQ_gwax), Power = gwaxPower, Method = "GWAX") %>%
dplyr::add_row(MeanNull = mean(nulls$CHISQ_cc), MeanCausal = mean(causals$CHISQ_cc), Power = ccPower, Method = "CaseControl")
#Looping through rest of files (if they exsist) and add them
for (i in 1:9){
file <- paste("./data/NineSims/",i,"/data/LTFH_",format(total_indiv,scientific = F),"_",format(SNP,scientific = F),"_",h*100,"_5_",sib,".qassoc", sep="")
if (file.exists(file)){
# Stringers for the current assoc-files
ltfh_string <- paste("./data/NineSims/",i,"/data/LTFH_",format(total_indiv,scientific = F),"_",format(SNP,scientific = F),"_",h*100,"_5_",sib,".qassoc", sep="")
cc_string <- paste("./data/NineSims/",i,"/data/case_ctrl","_",format(total_indiv,scientific = F),"_",format(SNP,scientific = F),"_",h*100,"_5.assoc", sep="")
gwax_string <- paste("./data/NineSims/",i,"/data/GWAX","_",format(total_indiv,scientific = F),"_",format(SNP,scientific = F),"_",h*100,"_5_",sib,".assoc", sep="")
#Reading assoc files
ltfh <- data.table::fread(ltfh_string)
gwax <- data.table::fread(gwax_string)
cc <- data.table::fread(cc_string)
#adding chisq to ltfh
ltfh$CHISQ <- qchisq(ltfh$P,df=1,lower.tail = FALSE)
#Check for found causals
ltfh$causal <- ifelse(ltfh$P < (0.05)/1000000,1,0)
gwax$causal <- ifelse(gwax$P < (0.05)/1000000,1,0)
cc$causal <- ifelse(cc$P < (0.05)/1000000,1,0)
#calculating-power
ltfhPower <- nrow(subset(ltfh, causal == 1))/1000
gwaxPower <- nrow(subset(gwax, causal == 1))/1000
ccPower <- nrow(subset(cc, causal == 1))/1000
#stringer for true-beta
beta_string <-  paste("./data/NineSims/",i,"/data/BETA","_",format(total_indiv,scientific = F),"_",format(SNP,scientific = F),"_",h*100,"_5.txt", sep="")
true_beta <- data.table::fread(beta_string)
# Joining to get true causals
causals <- true_beta %>%
dplyr::filter(V2 != 0) %>%
dplyr::left_join(select(ltfh,SNP,CHISQ), by = c("V1" = "SNP")) %>%
dplyr::rename("SNP" = "V1", "TrueBeta" = "V2", "CHISQ_ltfh" = "CHISQ") %>%
dplyr::left_join(select(gwax,SNP,CHISQ), by = c("SNP" = "SNP")) %>%
dplyr::rename("CHISQ_gwax" = "CHISQ") %>%
dplyr::left_join(select(cc,SNP,CHISQ), by = c("SNP" = "SNP")) %>%
dplyr::rename("CHISQ_cc" = "CHISQ")
#joining to get nulls
nulls <- true_beta %>%
dplyr::filter(V2 == 0) %>%
dplyr::left_join(select(ltfh,SNP,CHISQ), by = c("V1" = "SNP")) %>%
dplyr::rename("SNP" = "V1", "TrueBeta" = "V2", "CHISQ_ltfh" = "CHISQ") %>%
dplyr::left_join(select(gwax,SNP,CHISQ), by = c("SNP" = "SNP")) %>%
dplyr::rename("CHISQ_gwax" = "CHISQ") %>%
dplyr::left_join(select(cc,SNP,CHISQ), by = c("SNP" = "SNP")) %>%
dplyr::rename("CHISQ_cc" = "CHISQ")
df <- df %>%
dplyr::add_row(MeanNull = mean(nulls$CHISQ_ltfh), MeanCausal = mean(causals$CHISQ_ltfh), Power = ltfhPower, Method = "LT-FH") %>%
dplyr::add_row(MeanNull = mean(nulls$CHISQ_gwax), MeanCausal = mean(causals$CHISQ_gwax), Power = gwaxPower, Method = "GWAX") %>%
dplyr::add_row(MeanNull = mean(nulls$CHISQ_cc), MeanCausal = mean(causals$CHISQ_cc), Power = ccPower, Method = "CaseControl")
}else {print("no file")}
}
NullPlot <- ggplot2::ggplot(df, aes(x=Method, y=MeanNull))+
ggplot2::geom_boxplot()+
ggplot2::theme_light()
CausalPlot <- ggplot2::ggplot(df, aes(x=Method, y=MeanCausal))+
ggplot2::geom_boxplot()+
ggplot2::theme_light()
PowerPlot <- ggplot2::ggplot(df, aes(x=Method, y=Power))+
ggplot2::geom_boxplot()+
ggplot2::theme_light()
return(cowplot::plot_grid(NullPlot,CausalPlot,PowerPlot, ncol = 3))
} else {
print("No data exists! - Try another predefined or run our simulation")
}
total_indiv <- 100000
SNP <- 100000
h <- 0.5
sib <- 1
file <- paste("./data/LTFH","_",format(total_indiv,scientific = F),"_",format(SNP,scientific = F),"_",h*100,"_5_",sib,".qassoc", sep="")
if (file.exists(file)){
# Stringers for the first assoc-files
first_ltfh <- paste("./data/LTFH","_",format(total_indiv,scientific = F),"_",format(SNP,scientific = F),"_",h*100,"_5_",sib,".qassoc", sep="")
first_cc <- paste("./data/case_ctrl","_",format(total_indiv,scientific = F),"_",format(SNP,scientific = F),"_",h*100,"_5.assoc", sep="")
first_gwax <- paste("./data/GWAX","_",format(total_indiv,scientific = F),"_",format(SNP,scientific = F),"_",h*100,"_5_",sib,".assoc", sep="")
#Reading assoc files
ltfh <- data.table::fread(first_ltfh)
gwax <- data.table::fread(first_gwax)
cc <- data.table::fread(first_cc)
#adding chisq to ltfh
ltfh$CHISQ <- qchisq(ltfh$P,df=1,lower.tail = FALSE)
#Check for found causals
ltfh$causal <- ifelse(ltfh$P < (0.05)/1000000,1,0)
gwax$causal <- ifelse(gwax$P < (0.05)/1000000,1,0)
cc$causal <- ifelse(cc$P < (0.05)/1000000,1,0)
#calculating-power
ltfhPower <- nrow(subset(ltfh, causal == 1))/1000
gwaxPower <- nrow(subset(gwax, causal == 1))/1000
ccPower <- nrow(subset(cc, causal == 1))/1000
#stringer for true-beta
beta_string <-  paste("./data/BETA","_",format(total_indiv,scientific = F),"_",format(SNP,scientific = F),"_",h*100,"_5.txt", sep="")
true_beta <- data.table::fread(beta_string)
# Joining to get true causals
causals <- true_beta %>%
dplyr::filter(V2 != 0) %>%
dplyr::left_join(dplyr::select(ltfh,SNP,CHISQ), by = c("V1" = "SNP")) %>%
dplyr::rename("SNP" = "V1", "TrueBeta" = "V2", "CHISQ_ltfh" = "CHISQ") %>%
dplyr::left_join(dplyr::select(gwax,SNP,CHISQ), by = c("SNP" = "SNP")) %>%
dplyr::rename("CHISQ_gwax" = "CHISQ") %>%
dplyr::left_join(dplyr::select(cc,SNP,CHISQ), by = c("SNP" = "SNP")) %>%
dplyr::rename("CHISQ_cc" = "CHISQ")
#joining to get nulls
nulls <- true_beta %>%
dplyr::filter(V2 == 0) %>%
dplyr::left_join(dplyr::select(ltfh,SNP,CHISQ), by = c("V1" = "SNP")) %>%
dplyr::rename("SNP" = "V1", "TrueBeta" = "V2", "CHISQ_ltfh" = "CHISQ") %>%
dplyr::left_join(dplyr::select(gwax,SNP,CHISQ), by = c("SNP" = "SNP")) %>%
dplyr::rename("CHISQ_gwax" = "CHISQ") %>%
dplyr::left_join(dplyr::select(cc,SNP,CHISQ), by = c("SNP" = "SNP")) %>%
dplyr::rename("CHISQ_cc" = "CHISQ")
df <- tibble::tibble(MeanNull = mean(nulls$CHISQ_ltfh), MeanCausal = mean(causals$CHISQ_ltfh), Power = ltfhPower, Method = "LT-FH") %>%
dplyr::add_row(MeanNull = mean(nulls$CHISQ_gwax), MeanCausal = mean(causals$CHISQ_gwax), Power = gwaxPower, Method = "GWAX") %>%
dplyr::add_row(MeanNull = mean(nulls$CHISQ_cc), MeanCausal = mean(causals$CHISQ_cc), Power = ccPower, Method = "CaseControl")
#Looping through rest of files (if they exsist) and add them
for (i in 1:9){
file <- paste("./data/NineSims/",i,"/data/LTFH_",format(total_indiv,scientific = F),"_",format(SNP,scientific = F),"_",h*100,"_5_",sib,".qassoc", sep="")
if (file.exists(file)){
# Stringers for the current assoc-files
ltfh_string <- paste("./data/NineSims/",i,"/data/LTFH_",format(total_indiv,scientific = F),"_",format(SNP,scientific = F),"_",h*100,"_5_",sib,".qassoc", sep="")
cc_string <- paste("./data/NineSims/",i,"/data/case_ctrl","_",format(total_indiv,scientific = F),"_",format(SNP,scientific = F),"_",h*100,"_5.assoc", sep="")
gwax_string <- paste("./data/NineSims/",i,"/data/GWAX","_",format(total_indiv,scientific = F),"_",format(SNP,scientific = F),"_",h*100,"_5_",sib,".assoc", sep="")
#Reading assoc files
ltfh <- data.table::fread(ltfh_string)
gwax <- data.table::fread(gwax_string)
cc <- data.table::fread(cc_string)
#adding chisq to ltfh
ltfh$CHISQ <- qchisq(ltfh$P,df=1,lower.tail = FALSE)
#Check for found causals
ltfh$causal <- ifelse(ltfh$P < (0.05)/1000000,1,0)
gwax$causal <- ifelse(gwax$P < (0.05)/1000000,1,0)
cc$causal <- ifelse(cc$P < (0.05)/1000000,1,0)
#calculating-power
ltfhPower <- nrow(subset(ltfh, causal == 1))/1000
gwaxPower <- nrow(subset(gwax, causal == 1))/1000
ccPower <- nrow(subset(cc, causal == 1))/1000
#stringer for true-beta
beta_string <-  paste("./data/NineSims/",i,"/data/BETA","_",format(total_indiv,scientific = F),"_",format(SNP,scientific = F),"_",h*100,"_5.txt", sep="")
true_beta <- data.table::fread(beta_string)
# Joining to get true causals
causals <- true_beta %>%
dplyr::filter(V2 != 0) %>%
dplyr::left_join(dplyr::select(ltfh,SNP,CHISQ), by = c("V1" = "SNP")) %>%
dplyr::rename("SNP" = "V1", "TrueBeta" = "V2", "CHISQ_ltfh" = "CHISQ") %>%
dplyr::left_join(dplyr::select(gwax,SNP,CHISQ), by = c("SNP" = "SNP")) %>%
dplyr::rename("CHISQ_gwax" = "CHISQ") %>%
dplyr::left_join(dplyr::select(cc,SNP,CHISQ), by = c("SNP" = "SNP")) %>%
dplyr::rename("CHISQ_cc" = "CHISQ")
#joining to get nulls
nulls <- true_beta %>%
dplyr::filter(V2 == 0) %>%
dplyr::left_join(dplyr::select(ltfh,SNP,CHISQ), by = c("V1" = "SNP")) %>%
dplyr::rename("SNP" = "V1", "TrueBeta" = "V2", "CHISQ_ltfh" = "CHISQ") %>%
dplyr::left_join(dplyr::select(gwax,SNP,CHISQ), by = c("SNP" = "SNP")) %>%
dplyr::rename("CHISQ_gwax" = "CHISQ") %>%
dplyr::left_join(dplyr::select(cc,SNP,CHISQ), by = c("SNP" = "SNP")) %>%
dplyr::rename("CHISQ_cc" = "CHISQ")
df <- df %>%
dplyr::add_row(MeanNull = mean(nulls$CHISQ_ltfh), MeanCausal = mean(causals$CHISQ_ltfh), Power = ltfhPower, Method = "LT-FH") %>%
dplyr::add_row(MeanNull = mean(nulls$CHISQ_gwax), MeanCausal = mean(causals$CHISQ_gwax), Power = gwaxPower, Method = "GWAX") %>%
dplyr::add_row(MeanNull = mean(nulls$CHISQ_cc), MeanCausal = mean(causals$CHISQ_cc), Power = ccPower, Method = "CaseControl")
}else {print("no file")}
}
NullPlot <- ggplot2::ggplot(df, aes(x=Method, y=MeanNull))+
ggplot2::geom_boxplot()+
ggplot2::theme_light()
CausalPlot <- ggplot2::ggplot(df, aes(x=Method, y=MeanCausal))+
ggplot2::geom_boxplot()+
ggplot2::theme_light()
PowerPlot <- ggplot2::ggplot(df, aes(x=Method, y=Power))+
ggplot2::geom_boxplot()+
ggplot2::theme_light()
return(cowplot::plot_grid(NullPlot,CausalPlot,PowerPlot, ncol = 3))
} else {
print("No data exists! - Try another predefined or run our simulation")
}
total_indiv <- 100000
SNP <- 100000
h <- 0.5
sib <- 1
file <- paste("./data/LTFH","_",format(total_indiv,scientific = F),"_",format(SNP,scientific = F),"_",h*100,"_5_",sib,".qassoc", sep="")
if (file.exists(file)){
# Stringers for the first assoc-files
first_ltfh <- paste("./data/LTFH","_",format(total_indiv,scientific = F),"_",format(SNP,scientific = F),"_",h*100,"_5_",sib,".qassoc", sep="")
first_cc <- paste("./data/case_ctrl","_",format(total_indiv,scientific = F),"_",format(SNP,scientific = F),"_",h*100,"_5.assoc", sep="")
first_gwax <- paste("./data/GWAX","_",format(total_indiv,scientific = F),"_",format(SNP,scientific = F),"_",h*100,"_5_",sib,".assoc", sep="")
#Reading assoc files
ltfh <- data.table::fread(first_ltfh)
gwax <- data.table::fread(first_gwax)
cc <- data.table::fread(first_cc)
#adding chisq to ltfh
ltfh$CHISQ <- qchisq(ltfh$P,df=1,lower.tail = FALSE)
#Check for found causals
ltfh$causal <- ifelse(ltfh$P < (0.05)/1000000,1,0)
gwax$causal <- ifelse(gwax$P < (0.05)/1000000,1,0)
cc$causal <- ifelse(cc$P < (0.05)/1000000,1,0)
#calculating-power
ltfhPower <- nrow(subset(ltfh, causal == 1))/1000
gwaxPower <- nrow(subset(gwax, causal == 1))/1000
ccPower <- nrow(subset(cc, causal == 1))/1000
#stringer for true-beta
beta_string <-  paste("./data/BETA","_",format(total_indiv,scientific = F),"_",format(SNP,scientific = F),"_",h*100,"_5.txt", sep="")
true_beta <- data.table::fread(beta_string)
# Joining to get true causals
causals <- true_beta %>%
dplyr::filter(V2 != 0) %>%
dplyr::left_join(dplyr::select(ltfh,SNP,CHISQ), by = c("V1" = "SNP")) %>%
dplyr::rename("SNP" = "V1", "TrueBeta" = "V2", "CHISQ_ltfh" = "CHISQ") %>%
dplyr::left_join(dplyr::select(gwax,SNP,CHISQ), by = c("SNP" = "SNP")) %>%
dplyr::rename("CHISQ_gwax" = "CHISQ") %>%
dplyr::left_join(dplyr::select(cc,SNP,CHISQ), by = c("SNP" = "SNP")) %>%
dplyr::rename("CHISQ_cc" = "CHISQ")
#joining to get nulls
nulls <- true_beta %>%
dplyr::filter(V2 == 0) %>%
dplyr::left_join(dplyr::select(ltfh,SNP,CHISQ), by = c("V1" = "SNP")) %>%
dplyr::rename("SNP" = "V1", "TrueBeta" = "V2", "CHISQ_ltfh" = "CHISQ") %>%
dplyr::left_join(dplyr::select(gwax,SNP,CHISQ), by = c("SNP" = "SNP")) %>%
dplyr::rename("CHISQ_gwax" = "CHISQ") %>%
dplyr::left_join(dplyr::select(cc,SNP,CHISQ), by = c("SNP" = "SNP")) %>%
dplyr::rename("CHISQ_cc" = "CHISQ")
df <- tibble::tibble(MeanNull = mean(nulls$CHISQ_ltfh), MeanCausal = mean(causals$CHISQ_ltfh), Power = ltfhPower, Method = "LT-FH") %>%
dplyr::add_row(MeanNull = mean(nulls$CHISQ_gwax), MeanCausal = mean(causals$CHISQ_gwax), Power = gwaxPower, Method = "GWAX") %>%
dplyr::add_row(MeanNull = mean(nulls$CHISQ_cc), MeanCausal = mean(causals$CHISQ_cc), Power = ccPower, Method = "CaseControl")
#Looping through rest of files (if they exsist) and add them
for (i in 1:9){
file <- paste("./data/NineSims/",i,"/data/LTFH_",format(total_indiv,scientific = F),"_",format(SNP,scientific = F),"_",h*100,"_5_",sib,".qassoc", sep="")
if (file.exists(file)){
# Stringers for the current assoc-files
ltfh_string <- paste("./data/NineSims/",i,"/data/LTFH_",format(total_indiv,scientific = F),"_",format(SNP,scientific = F),"_",h*100,"_5_",sib,".qassoc", sep="")
cc_string <- paste("./data/NineSims/",i,"/data/case_ctrl","_",format(total_indiv,scientific = F),"_",format(SNP,scientific = F),"_",h*100,"_5.assoc", sep="")
gwax_string <- paste("./data/NineSims/",i,"/data/GWAX","_",format(total_indiv,scientific = F),"_",format(SNP,scientific = F),"_",h*100,"_5_",sib,".assoc", sep="")
#Reading assoc files
ltfh <- data.table::fread(ltfh_string)
gwax <- data.table::fread(gwax_string)
cc <- data.table::fread(cc_string)
#adding chisq to ltfh
ltfh$CHISQ <- qchisq(ltfh$P,df=1,lower.tail = FALSE)
#Check for found causals
ltfh$causal <- ifelse(ltfh$P < (0.05)/1000000,1,0)
gwax$causal <- ifelse(gwax$P < (0.05)/1000000,1,0)
cc$causal <- ifelse(cc$P < (0.05)/1000000,1,0)
#calculating-power
ltfhPower <- nrow(subset(ltfh, causal == 1))/1000
gwaxPower <- nrow(subset(gwax, causal == 1))/1000
ccPower <- nrow(subset(cc, causal == 1))/1000
#stringer for true-beta
beta_string <-  paste("./data/NineSims/",i,"/data/BETA","_",format(total_indiv,scientific = F),"_",format(SNP,scientific = F),"_",h*100,"_5.txt", sep="")
true_beta <- data.table::fread(beta_string)
# Joining to get true causals
causals <- true_beta %>%
dplyr::filter(V2 != 0) %>%
dplyr::left_join(dplyr::select(ltfh,SNP,CHISQ), by = c("V1" = "SNP")) %>%
dplyr::rename("SNP" = "V1", "TrueBeta" = "V2", "CHISQ_ltfh" = "CHISQ") %>%
dplyr::left_join(dplyr::select(gwax,SNP,CHISQ), by = c("SNP" = "SNP")) %>%
dplyr::rename("CHISQ_gwax" = "CHISQ") %>%
dplyr::left_join(dplyr::select(cc,SNP,CHISQ), by = c("SNP" = "SNP")) %>%
dplyr::rename("CHISQ_cc" = "CHISQ")
#joining to get nulls
nulls <- true_beta %>%
dplyr::filter(V2 == 0) %>%
dplyr::left_join(dplyr::select(ltfh,SNP,CHISQ), by = c("V1" = "SNP")) %>%
dplyr::rename("SNP" = "V1", "TrueBeta" = "V2", "CHISQ_ltfh" = "CHISQ") %>%
dplyr::left_join(dplyr::select(gwax,SNP,CHISQ), by = c("SNP" = "SNP")) %>%
dplyr::rename("CHISQ_gwax" = "CHISQ") %>%
dplyr::left_join(dplyr::select(cc,SNP,CHISQ), by = c("SNP" = "SNP")) %>%
dplyr::rename("CHISQ_cc" = "CHISQ")
df <- df %>%
dplyr::add_row(MeanNull = mean(nulls$CHISQ_ltfh), MeanCausal = mean(causals$CHISQ_ltfh), Power = ltfhPower, Method = "LT-FH") %>%
dplyr::add_row(MeanNull = mean(nulls$CHISQ_gwax), MeanCausal = mean(causals$CHISQ_gwax), Power = gwaxPower, Method = "GWAX") %>%
dplyr::add_row(MeanNull = mean(nulls$CHISQ_cc), MeanCausal = mean(causals$CHISQ_cc), Power = ccPower, Method = "CaseControl")
}else {print("no file")}
}
NullPlot <- ggplot2::ggplot(df, ggplot2::aes(x=Method, y=MeanNull))+
ggplot2::geom_boxplot()+
ggplot2::theme_light()
CausalPlot <- ggplot2::ggplot(df, ggplot2::aes(x=Method, y=MeanCausal))+
ggplot2::geom_boxplot()+
ggplot2::theme_light()
PowerPlot <- ggplot2::ggplot(df, ggplot2::aes(x=Method, y=Power))+
ggplot2::geom_boxplot()+
ggplot2::theme_light()
return(cowplot::plot_grid(NullPlot,CausalPlot,PowerPlot, ncol = 3))
} else {
print("No data exists! - Try another predefined or run our simulation")
}
cowplot::plot_grid(NullPlot,CausalPlot,PowerPlot, ncol = 3)
NullPlot <- ggplot2::ggplot(df, ggplot2::aes(x=Method, y=MeanNull))+
ggplot2::geom_boxplot()+
ggplot2::labs(title = latex2exp::TeX('Average null $\\chi^2$'))+
ggplot2::theme_light()
CausalPlot <- ggplot2::ggplot(df, ggplot2::aes(x=Method, y=MeanCausal))+
ggplot2::geom_boxplot()+
ggplot2::labs(title = latex2exp::TeX('Average causal $\\chi^2$'))+
ggplot2::theme_light()
PowerPlot <- ggplot2::ggplot(df, ggplot2::aes(x=Method, y=Power))+
ggplot2::geom_boxplot()+
ggplot2::labs(title = "Power")+
ggplot2::theme_light()
cowplot::plot_grid(NullPlot,CausalPlot,PowerPlot, ncol = 3)
NullPlot <- ggplot2::ggplot(df, ggplot2::aes(x=Method, y=MeanNull))+
ggplot2::geom_boxplot()+
ggplot2::labs(title = latex2exp::TeX('Average null $\\chi^2$'))+
ggplot2::theme_light()
CausalPlot <- ggplot2::ggplot(df, ggplot2::aes(x=Method, y=MeanCausal))+
ggplot2::geom_boxplot()+
ggplot2::labs(title = latex2exp::TeX('Average causal $\\chi^2$'))+
ggplot2::theme_light()
PowerPlot <- ggplot2::ggplot(df, ggplot2::aes(x=Method, y=Power))+
ggplot2::geom_boxplot()+
ggplot2::labs(title = "Power")+
ggplot2::theme_light()+
ggplot2::theme(axis.title.x = element_blank(),
axis.title.y = element_blank())
NullPlot <- ggplot2::ggplot(df, ggplot2::aes(x=Method, y=MeanNull))+
ggplot2::geom_boxplot()+
ggplot2::labs(title = latex2exp::TeX('Average null $\\chi^2$'))+
ggplot2::theme_light()
CausalPlot <- ggplot2::ggplot(df, ggplot2::aes(x=Method, y=MeanCausal))+
ggplot2::geom_boxplot()+
ggplot2::labs(title = latex2exp::TeX('Average causal $\\chi^2$'))+
ggplot2::theme_light()
PowerPlot <- ggplot2::ggplot(df, ggplot2::aes(x=Method, y=Power))+
ggplot2::geom_boxplot()+
ggplot2::labs(title = "Power")+
ggplot2::theme_light()+
ggplot2::theme(axis.title.x = ggplot2::element_blank(),
axis.title.y = ggplot2::element_blank())
cowplot::plot_grid(NullPlot,CausalPlot,PowerPlot, ncol = 3)
NullPlot <- ggplot2::ggplot(df, ggplot2::aes(x=Method, y=MeanNull))+
ggplot2::geom_boxplot()+
ggplot2::labs(title = latex2exp::TeX('Average null $\\chi^2$'))+
ggplot2::theme_light()+
ggplot2::theme(axis.title.x = ggplot2::element_blank(),
axis.title.y = ggplot2::element_blank())
CausalPlot <- ggplot2::ggplot(df, ggplot2::aes(x=Method, y=MeanCausal))+
ggplot2::geom_boxplot()+
ggplot2::labs(title = latex2exp::TeX('Average causal $\\chi^2$'))+
ggplot2::theme_light()+
ggplot2::theme(axis.title.x = ggplot2::element_blank(),
axis.title.y = ggplot2::element_blank())
PowerPlot <- ggplot2::ggplot(df, ggplot2::aes(x=Method, y=Power))+
ggplot2::geom_boxplot()+
ggplot2::labs(title = "Power")+
ggplot2::theme_light()+
ggplot2::theme(axis.title.x = ggplot2::element_blank(),
axis.title.y = ggplot2::element_blank())
cowplot::plot_grid(NullPlot,CausalPlot,PowerPlot, ncol = 3)
NullPlot <- ggplot2::ggplot(df, ggplot2::aes(x=Method, y=MeanNull))+
ggplot2::geom_boxplot()+
ggplot2::labs(title = latex2exp::TeX('Average null $\\chi^2$'))+
ggplot2::theme_light()+
ggplot2::theme(axis.title.x = ggplot2::element_blank(),
axis.title.y = ggplot2::element_blank(),
plot.title = ggplot2::element_text(hjust = 0.5))
CausalPlot <- ggplot2::ggplot(df, ggplot2::aes(x=Method, y=MeanCausal))+
ggplot2::geom_boxplot()+
ggplot2::labs(title = latex2exp::TeX('Average causal $\\chi^2$'))+
ggplot2::theme_light()+
ggplot2::theme(axis.title.x = ggplot2::element_blank(),
axis.title.y = ggplot2::element_blank(),
plot.title = ggplot2::element_text(hjust = 0.5))
PowerPlot <- ggplot2::ggplot(df, ggplot2::aes(x=Method, y=Power))+
ggplot2::geom_boxplot()+
ggplot2::labs(title = "Power")+
ggplot2::theme_light()+
ggplot2::theme(axis.title.x = ggplot2::element_blank(),
axis.title.y = ggplot2::element_blank(),
plot.title = ggplot2::element_text(hjust = 0.5))
cowplot::plot_grid(NullPlot,CausalPlot,PowerPlot, ncol = 3)
setwd("C:\\Users\\Bruger\\Desktop\\DataProjectGWAS")
setwd("./GWAS")
library("devtools")
document()
